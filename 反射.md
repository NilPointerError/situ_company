## 反射

一个类有：成员变量、方法、构造方法、包等等信息，利用反射技术可以对一个类进行解剖，把个个组成部分映射成一个个对象。

获取类对象的三种方式

```java
Class clazz=Demo.class;
clazz=new Demo().getClass();
clazz=Class.forName("com.test23.Demo");
```

获取一个类中定义的属性

```java
Field f1=clazz.getField("name");//getField("属性名字") 获取一个指定名字public定义的属性
Field[] f_arr=clazz.getFields();//getFields 获取所有public定义的属性
//获取所有定义的属性包括private
//反射会破坏封装性
f1=clazz.getDeclaredField("weight");
f_arr=clazz.getDeclaredFields();
/*
getField 只能获取public的，包括从父类继承来的字段。
getDeclaredField 可以获取本类所有的字段，包括private的，但是不能获取继承来的字段。 (注： 这里只能获取到private的字段，但并不能访问该private字段的值,除非加上setAccessible(true))
*/
```

通过反射实例化对象

```java
Object obj=clazz.newInstance();
```

设置属性可访问

```java
f1.setAccessible(true);
```

给对象注入属性值

```java
f1.set(obj,81);
f1.get(obj);
System.out.println(obj);
```

获取方法

```java
Method m1=clazz.getMethod("test1",String.class,Date.class);
m1.invoke(obj,"你好",null);//通过方法对象驱动一个对象执行该方法
//通过参数列表获取构造方法
Method[] m_arr=clazz.getDeclaredMethods();
//通过构造方法实例化对象
Constructor con=clazz.getDeclaredConstructor();
//通过构造方法实例化对象
con.newInstance();
```

获取父类和接口

```java
Class su=clazz.getSuperclass();
Class[] c_arr=clazz.getInterfaces();
```

获取类属性的修饰符

```java
int m=f1.getModifiers();
boolean b = Modifier.isPublic(m);//判断是否为public修饰符
b=Modifier.isPrivate(m);
b=Modifier.isStatic(m);
```

内省  获得BeanInfo对象  针对javabean的操作

```java
BeanInfo bi=Introspector.getBeanInfo(clazz);
//获取属性的介绍
PropertyDescriptor[] ppd_arr=bi.getPropertyDescriptors();
System.out.println(ppd_arr[0].getName());
//执行obj中的set方法
ppd_arr[0].getWriteMethod().invoke(obj, 18);

```

```java
package com.atguigu.java;


import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

class Thread1  {

    int i = 2;
    public int setI(Integer i) {
        this.i = i;
        return 8;
    }

    public int getI() {
        return i;
    }
}

public class Main {

    public static void main(String[] args) throws NoSuchFieldException, InstantiationException, IllegalAccessException, NoSuchMethodException, InvocationTargetException {
        Class clazz = Thread1.class;
        Field f = clazz.getDeclaredField("i");
        Object obj = clazz.newInstance();
        f.setInt(obj,5);
        Method m = clazz.getDeclaredMethod("setI",Integer.class);
        Object obj2 = m.invoke(obj,13);
        System.out.println("obj2 = " + obj2);
        Thread1 t = (Thread1)obj;
        System.out.println(t.getI());
    }
}
```
