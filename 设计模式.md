# 设计模式

## 工厂模式

![](C:\Users\Admin\Desktop\Java Notes\pic\4.jpg)

## 抽象工厂模式

![](C:\Users\Admin\Desktop\Java Notes\pic\5.jpg)

## 单例模式

线程

## 建造者模式

## 适配器模式

## 过滤器模式

## 代理模式

### 静态代理模式

![image-20220811221125046](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20220811221125046.png)

```java
interface IWorker{
    void dosomething();
}
//实际业务类
class WorkA implements IWorker{
    @Override
    public void dosomething(){
        System.out.println("---实际的业务逻辑代码---");
    }
}
//代理类
class WorkProxy implements IWorker{
    IWorker worker;
    WorkerProxy(IWorker worker){
        this.worker=worker;
    }
    
    @Override
    public void dosomething(){
        System.out.println("--前置代码--");
        worker.dosomething();
        System.out.println("--后置代码--");
    }
}
//代理工厂
class ProxyFactory{
    static IWorker getProxy(){
        IWorker w=new WorkerA();
        return new WorkerProxy(w);
    }
}
public class Easy{
    public static void main(String[] args){
        IWorker worker=ProxyFactory.getProxy();
        worker.dosomething();
    }
}
```

### 动态代理模式

#### JDK动态代理

```java
interface IWorker{
    String dosomething();
}
class WorkA implements IWorker{
    @Override
    public String dosomething(){
		System.out.println("---实际的业务逻辑代码");
        return "你好";
    }
}
interface IWorker2{
	String dosomething();
}
class WorkerA2 implements IWorker{
    public String dosomething(){
        System.out.println("---实际的业务逻辑代码2222");
        return "你好222";
    }
}

class MyProxy implements InvocationHandler{
    Object proxyedObj;
    public MyProxy(Object proxyedObj){
        this.proxyedObj=proxyedObj;
    }
    @Override
    public Object invoke(Object proxy,Method method,Object[] args){
    	Object result=null;
        System.out.println("---前置代码");
        try{
            result=method.invoke(proxyed, args);
            System.out.println("---正常完成业务的代码");
        } catch(Exception e){
            System.out.println("---异常情况下执行代码");
        } finally{
            System.out.println("---后置代码块");
        }
        return result;
    }
}
class ProxyFactory{
    static Object getProxy(Object obj){
        Class clazz=obj.getClass();
        MyProxy proxytask=new MyProxy(obj);
        return Proxy.newProxyInstance(clazz.getClassLoader(),clazzgetInterfaces(),proxytask);
    }
}

public class Easy{
    public static void main(String[] args){
        IWorker worker=new WorkerA();
        IWorker obj=ProxyFactory.getProxy(worker);
        obj.dosomething();
    }
}

```

#### CGLIB动态代理

CGLIB全称为Code Generation Library，是一个强大的，高性能，高质量的基于ASM字节码生产类库，它可以在运行期扩展Java类与实现Java接口

```java
class Worker{
    void test(){
        System.out.println("----实际业务逻辑");
    }
}
class Factory implements MethodInterceptor{
    Object proxyedObj;
    Factory(Object proxyedObj){
        this.proxyedObj=proxyedObj;
    }
    
    public Object getProxy(){
        Enhancer en=new Enhancer();
        en.setSuperclass(proxyedObj.getClass());
        en.setCallback(this);
        return en.create();
    }
    
    public Object intercept(Object arg0, Method method, Object[] args, MethodProxy proxy) throws Throwable {
        System.out.println("---前置代码");
        Object result=method.invoke(proxyedObj,args);
        System.out.println("---后置代码");
        return result;
    }
    
}

public class Easy{
    public static void main(String[] args){
        Worker worker=new Worker();
        Factory f=new Factory(worker);
        worker=(Worker)f.getProxy();//获取代理
        worker.test();//执行代理方法
    }
}
```

## 命令模式



